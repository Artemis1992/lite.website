## Теперь разберем третий компонент - Партерн MTV
**MTV(Models, Templetes, Views)**

**Что это такое? Если мы перейдем в наш проект, Запустим тестовый Веб сервер**
```
(venv) PS D:\My Dream\virtual environment\coolsite> python manage.py runserver
```
**У нас выдает исключение, нам нужно убрать из адреса в файле coolsite/urls.py следующую строку 'people/' и сделаем ее пустой следующим образом**
```
    path('', include('people.urls'))
```
**Так же уберем и в файле по адресу people/urls.py следующую строку.**
```
    path('', index, name='home'),
```
**Все это теперь сохраним в git и закоммитим.**

**Теперь снова попробуем открыть наше веб-приложение, если все сделали правильно то оно должно открытся с текстом ***Страница приложения people*** И как понимаем это не полноценная html-страница!  Она содержит горахдо больше информации в том числе заголовок и статические подключаемые файлы. Конечно же если решать эту задачу в лоб и сформировать полноценную сьтраницу, Непосредственно в функции предстовления то, это выглядело примерно так...**
```
def index(request):
    return HtttpResponce('''<!DOCTYPE html>
<html>
<head>
    <title></title>
</head>
<body>

</body>
</html>''')
```
**Обновим страницу и нажмем посмотреть код в браузере, и как раз наша html-страница отобразится. Но давайте представим во что превратится программа если прописывать ее таким вот образом. Поэтому это все выносится за пределы приложения и организуется в виде шаблонов html-страниц. И сейчас мы узнаем как в Django организованы шаблоны где их хранить и как их подключать.**

**Как предстовляеться шаблоны в Django...
Работа очень пахожа на работу шаблонизатора. Oбучающее видео по ссылки тут -> [Jinja 2](https://youtu.be/cFJqMXxVNsI?si=XZ_MMEkiUaaZ504I)**

**Документация по шаблонам [Django](https://docs.djangoproject.com/en/5.1/)**

**Допустим мы хотим отабразить некторый шаблон который будет храниться в файле индекс HTML**

**Импортируем встроенный в Django шаблонизатор;**

**Переходим в проект. В файл views.py который отвечает за функцию предстовления.
И видем что импортирована функция render она и есть встоенная функция шаблонизатора Django. И именно она производит обработку наших шаблонов. Теперь перепишем нашу функцию index следующим образом. В качестве первого параметра у этой функции обязательно нужно передать параметр request и далее вторым параметром нужно прописать путь к шаблону ---- return render(request, 'people/index.html')**
```
def index(request):
    return render(request, '')
```
**И где теперь распологать файлы шаблонов нашего приложения people.**

**Обычно они хронятся в деректории templates. Так же мы можем хранить все наши шаблоны в этой деректории. Но есть тут один важный нюанс, при сборки всего проекта, когда мы его выкладжываем на боевой веб-сервер, то все шаблоны помещаются в единую папку с именем тоже templates но она будет уже едина для всего проекта. Если окажется что в разных приложениях будет два одинаковых файла с одинаковыми именами то, возникнет неопределенность. На самом деле будет взят первый попавшийся файл. Что бы этого не происходило, в папке templates принето создовать еще один подкоталог.**
```
project/
│
├── templates/
│   ├── people
│   │   ├── base.html
│   │   └── index.html
│
└── other_project_files/
    ├── settings.py
    ├── views.py
    └── models.py

```
**При такой структуре у нас people целиком перенесется в подкаталог templates при сборки всего проекта и у нас не будет возникать никаких проблем с именами файлов.**

**Помещаем теперь файл index.html по пути *coolsite\people\templates\people* В этом файле мы пропишем следующие строки.**
```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Известные люди</title>
</head>
<body>
    
</body>
</html>
```
***Или просто ввести ! после Tab. Восклицательный знак должен сгенерировать базовую структуру HTML если по какой то пречины это не сработало то нужно включить Emmet в настройках. Жмем <Ctrl + ,>. В строке поиска введи Emmet и убедись, что опции Emmet включены для файлов HTML.***

**Теперь определим путь к нашему файлу index.html. В фале views.py в функции index указываем в каком каталоге он находится.**
```
def index(request):
    return render(request, 'people/index.html')
```
**Но почему мы не указываем полный путь к файлую Дело в том что по умолчанию в файле setings.py указанны по умолчанию где файлы будут искатся.**
```
TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [],
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]
```
**И название должно соответствовать templates, иначе у нас ничего не заработает. А дальше имена каталогов и вложенные файлы мы можем придумывать сами. Сохраняем и перезагружаем веб-сервер, проверяем.**

**Теперь у нас вкладка главной страницы имеет название *Известные люди*, И так же можем посмотреть на содержимое этой страницы. Действительно был взят шаблон и он отобразился на главной страницы, шоблонитизатор отработал как надо и функция *render* в файле views.py, отобразила файл index.html. Таким образом мы отделили код нашего приложения от шаблонов. И мы теперь може отдельно менять содержимое наших шаблонов не меняя самого приложения.**

**Добавим еще один шаблон с названием about.html который будет содержать информацию о сайте. Заголовком у нас будет называтся "О сайте" и заголовок первого уровля тоже, "О сайте".**
```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>О Сайте</title>
</head>
<body>
    <h1>О Сайте</h1>
</body>
</html>
```
**Теперь у нас 2 шаблона about.html и index.html.**

**И теперь в файле views.py пропишем функцию обработчик для отображения этого шаблона. Функция будет у нас называтся так же about и соответственно вместо index.html мы указывае about.html**
```
def about(request):
    return render(request, 'people/about.html')
```
**Далее нам нужно прописать маршрут для нашей функции. Прописываем его по адресу people\urls.py. В нем мы уберем следующие строки которые нам теперь не нужны.**
```
    path('cats/<int:catid>/', categories),
    re_path(r'^archive/(?P<year>[0-9]{4})/', archive),
```
**И вместо этих строк мы пропишем маршрут к нашей функции about, которая ссылается на шаблон about.html.**
```
urlpatterns = [
    path('', index, name='home'),
    path('about/', about, name='about'),           <---

]
```
**Переходим в нашу веб-страницу и сморим, если мы пропишем путь /about то отобразится другой шаблон, тут мы увидем "О Сайте" заголовок и заголовок первого уровня тоже "О сайте". Вот так в простом варианте можно добавлять шаблоны в наше приложение и отображать с помощью функций предстовлений используя шаблонитизатор через функцию render.**

***
## Что такое шаблоны в Django, общее предстовление
* ### *в Django шаблоны (templates) — это механизм для отображения данных на веб-страницах. Шаблоны используются для того, чтобы отделить логику приложения (например, работу с базой данных) от отображения данных пользователю.*

* ### *Шаблоны в Django состоят из HTML-кода, в который можно встраивать динамические данные с помощью специального синтаксиса. Обычно это делается через контекст, который передаётся в шаблон из views (представлений).*

* ### *Основные возможности шаблонов в Django:*

* ### *Вывод данных: через синтаксис {{ переменная }} можно вывести данные из контекста.*
* ### *Логика: в шаблонах можно использовать простую логику, например, циклы и условия, с помощью конструкций {% %}.*
* ### *Наследование: шаблоны могут наследоваться друг от друга, что позволяет создавать общий каркас (layout) страницы и переиспользовать его для разных страниц.*
* ### *Фильтры: позволяют форматировать данные перед их отображением (например, {{ дата|date:"d M Y" }} отформатирует дату).*
* ### *Таким образом, шаблоны в Django используются для создания динамически генерируемых страниц, отображающих информацию из базы данных или других источников.*
*** 
**И так, пропишем конструкцию которая будет отображать информацию из базы данных. И в качестве заголовка в файле index.html а именно "Главная страница", вместо нее пропишем переиенную и пусть она называется {{ title }}. Мы так же пропишем и в файле about.html, вместо строчки "О сайте", тоже {{ title }}**

### index.html
```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
</head>
<body>
    
</body>
</html>
```
### about.html
```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
</head>
<body>
    <h1>О Сайте</h1>
</body>
</html>
```

***Так откуда эта переменная будет взята***

**Перейдем в файл views.py и мы можем шаблонам передовать параметры. Параметры передаются третим аргументом в виде словаря. Пропишем словарь в функции index, укажим ключ(это наша переменная которая будет доступна в шаблоне) а значением укажим 'Главная страница'**
```
def index(request):
    return render(request, 'people/index.html', {'title': 'Главная сттроаница'})
```
**Тоже самое мы делаем и во второй функции**
```
def about(request):
    return render(request, 'people/about.html', {'title': 'О сайте'})
```
**Теперь перейдем на нашу страницу и обнавим, как видем наши страницы остались прежними. http://127.0.0.1:8000/about/    -     http://127.0.0.1:8000   таким образом мы можем нашим шаблонам передавать самые разные параметры **

**Или можно сделать немного посложнее, допустим у нас есть список меню для сайта. Пропишим ее в views.py**
```
menu = ["О сайте", "Добавить статью", "Обратная связь", "Войти"]
```
**И мы хотим отобразить этот список на главной странице. Пропишем в функции index дополнительно еще один параметр в словарь.**
```
def index(request):
    return render(request, 'people/index.html', {"menu": menu, 'title': 'Главная сттроаница'})

```
**Теперь воспользуемся в шаблоне index.html параметром menu и отобразим этот список.**
```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
</head>
<body>
    
    <ul>
        {% for m in menu %}
        <li>{{m}}</li>
        {% endfor %}
    </ul>

</body>
</html>
```
**Теперь посмотрим как это все будет отображатся в браузере.**
```
О сайте
Добавить статью
Обратная связь
Войти
```
**Тоже самое можно сделать и для функции about.html и оно тоже будет отображатся на странице. Добавим в about.html тот же цикл перебора в body-тело и пропишем "menu": menu, в функции about в views.py и на странице http://127.0.0.1:8000/about/ И на странице отобразится такое же меню.**

**Главное правило в програмировани. Не повторяйся! И как видем в index.html и  about.html содержит один и тот же код. И чтобы устранить этот недостаток обычно создается базовый шаблон для предстовление страниц на сайте в целом. А уже потом он расширяется шаблонами отдельных страниц.**

**Сформируем базовый шаблон "base.html"**
```
<!DOCTYPE html>
<html>
<head>
    <title>{{title}}</title>
</head>
<body>
    {% block mainmenu %}
    <ul>
        {% for m in menu %}
    <li>{{m}}</li>
        {% endfor %}
    </ul>
    {% endblock mainmenu %}

    {% block content %}
    {% endblock %}
</body>
</html>

```
```
1. <!DOCTYPE html> — Объявление типа документа: указывает, что это HTML5-документ.
2. <html> — Начало HTML-документа.
3. <head> — Заголовочная часть документа, где находятся мета-информации, стили и заголовок.
4. <title>{{title}}</title> — Заголовок страницы. Используется Jinja2-шаблон, чтобы подставить значение переменной title.
5. </head> — Завершение заголовочной части.
6. <body> — Основная часть страницы (тело документа).
7. {% block mainmenu %} — Определение блока mainmenu. Этот блок можно переопределить в других шаблонах.
8. <ul> — Открытие ненумерованного списка (ul).
9. {% for m in menu %} — Цикл for Jinja2, который проходит по элементам переменной menu.
10. <li>{{m}}</li> — Элемент списка. Каждый элемент списка menu выводится как <li>.
11. {% endfor %} — Завершение цикла for.
12. </ul> — Закрытие списка ul.
13. {% endblock mainmenu %} — Завершение блока mainmenu.
14. {% block content %} — Блок content. Его содержимое можно переопределить в расширяющих шаблонах. Основной контент страницы.
15. {% endblock %} — Завершение блока content.
16. </body> — Завершение основной части страницы.
17. </html> — Завершение HTML-документа.
```
**Блоки будем наполнять в файлах которые у нас есть, это index.html и about.html. И соответственно в файле index.htm мы перепишем код.**
```
{% extends "women/base.html" %}

{% block content %}
<h1>{{title}}</h1>
<p>Содержимое Главной страницы</p>
{% endblock %}
```
```
{% extends "women/base.html" %} <!-- Расширение шаблона "base.html", который находится в папке "women" -->

{% block content %} <!-- Определение блока контента, который будет вставлен в родительский шаблон -->
<h1>{{title}}</h1> <!-- Заголовок страницы, подставляется динамически с использованием переменной "title" -->
<p>Содержимое Главной страницы</p> <!-- Текстовое содержимое для главной страницы -->
{% endblock %} <!-- Конец блока контента -->

```
**Тоже самое напишем и в about.html но, текстовое содержимое изменимю.**
```
{% extends "women/base.html" %}

{% block content %}
<h1>{{title}}</h1>
<p>Содержимое страницы о сайте</p>
{% endblock %}
```
```
{% extends "women/base.html" %} <!-- Расширение шаблона "base.html", который находится в папке "women" -->

{% block content %} <!-- Определение блока контента, который будет вставлен в родительский шаблон -->
<h1>{{title}}</h1> <!-- Заголовок страницы, подставляется динамически с использованием переменной "title" -->
<p>Содержимое страницы о сайте</p> <!-- Текстовое содержимое страницы о сайте -->
{% endblock %} <!-- Конец блока контента -->
```
**Перехордим на веб-страницу и видем, тепрь Главная страница http://127.0.0.1:8000/ и О сайте http://127.0.0.1:8000/about/ отображается как мы планировали но все еще все это не похожа она на полноценный сайт. **

***Вот так вот используя наследования шаблонов и тем не менее расширение базового шаблона мы исключаем дублирование в дочерних шаблонов. И именно так принято делать, создается базовый шаблон единый для предстьовление страниц на сайте а потом уже мы создаем дочернии шаблоны.***

**И теперь когда мы разобрались что из себя предстовляют базовые шаблоны в базовом понимание. Теперь выполним чтение данных из таблицы people. И отобразим список статей на главной странице. Для этого переходим в модуль views.py и импортируем все наши модели.**
```
from .models import *
```
**В функции предстовлении index в том же модуле views.py пропишем следующую уже известную команду.**
```
def index(request):
    posts = People.objects.all()
    return render(request, 'people/index.html', {"menu": menu, 'title': 'Главная сттроаница'})
```
**Выберем все записи и сохраним все записи в переменную posts. И соотвтетственно мы должны ее передать в эту же функцию в качестве параметра в словарь.**
```
... 
... {"posts": posts, "menu": menu, 'title': 'Главная сттроаница'}
```
**Теперь в index.html достаточно отобразить этот posts. Переходим index.html и вместо обзаца ```<p>Содержимое Главной страницы</p>``` пропишем такой код.**
```
<ul>
    {% for p in posts %} <!-- Цикл, который проходит по элементам "posts" -->
    <li>
        <h2>{{p.title}}</h2> <!-- Отображение заголовка каждого поста -->
        <p>{{p.content}}</p> <!-- Отображение содержимого каждого поста -->
        <hr> <!-- Разделительная линия -->
    </li>
    {% endfor %} <!-- Конец цикла -->
</ul>
```
**Переходим в браузер и смотрим как это все будет работать. И действительно все отобразилось как надо, Зоголовки и посты у нас отобразились.**
* ## Анджелина Джоли
    Биография Анджелина Джоли

* ## Марго Робби
     Биография Марго Робби

* ## Джулия Робертс
     Биография Джулии Робертс

* ## Ума Турман
     Биография Умы Турман





























