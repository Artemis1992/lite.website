## Добавление отображения статей по слагу в Django

1. ## Добавление поля ```slug``` в модель

    **Чтобы реализовать отображение статей по слагу, начнём с добавления нового поля ```slug``` в модель. Открываем файл ```models.py``` и добавляем поле:**

    ```
    slug = models.SlugField(max_length=255, unique=True, db_index=True, verbose_name="URL")
    ```

   * **```SlugField```: Специальный класс в Django, предназначенный для хранения слагов.**

   * **```max_length=255```: Максимальная длина строки слага.**

   * **```unique=True```: Слаг должен быть уникальным для каждой записи.**

   * **```db_index=True```: Индексация поля для ускорения поиска.**

   * **```verbose_name="URL"```: Название поля в админке, отображающееся как "URL".**

2. ## Обновление базы данных

    **После добавления нового поля необходимо обновить таблицу ```people``` в базе данных. Запускаем создание миграций:**

    ```
    python manage.py makemigrations
    ```
    **Если в таблице уже есть записи, возникнет предупреждение о том, что поле ```slug``` не может быть пустым, так как:**

   * **Поле ```slug``` должно быть уникальным.**

   * **Оно автоматически создаётся пустым для существующих записей.**

3. ## Решение проблемы с пустыми полями

    **Чтобы корректно обновить базу данных:**

   * **Удаляем параметр ```null=True``` для внешнего ключа ```cat``` в таблице модели People.**

   * **Полностью перестраиваем базу данных:**

      * **Удаляем существующие миграции (```0001```, ```0002```, ```0003``` и т.д.).**

      * **Удаляем файл базы данных ```db.sqlite3```.**

**Затем в файле ```models.py``` добавляем в модель ```Category``` аналогичное поле ```slug```:**
```
    slug = models.SlugField(  
        max_length=255,  # Максимальная длина строки
        unique=True,     # Значение должно быть уникальным
        db_index=True,   # Добавить индекс в базе данных
        verbose_name="URL"  # Читаемое название поля
    )
```
**Создаём новые миграции:**
```
python manage.py makemigrations
```
**Применяем миграции:**
```
python manage.py migrate
```
**Теперь база данных перестроена, и в ней есть обновлённые таблицы для моделей ```People``` и ```Category``` с добавленным полем ```slug```.**

4. ## Создание суперпользователя

    **Если база данных была очищена, создаём нового суперпользователя для доступа к админке:**
    ```
    python manage.py createsuperuser
    ```
    **Заполняем данные (например):**

    * **Имя пользователя: ```root```**

    * **Email: ```root@coolsite.com```**

    * **Пароль: вводим и подтверждаем.**

5. ## Автоматическое заполнение поля ```slug```

    **Чтобы автоматически формировать значение поля ```slug``` на основе другого поля, например, name или ```title```, редактируем файл ```admin.py```.**

    **Для модели ```Category``` в классе ```CategoryAdmin``` добавляем:**
    ```
    prepopulated_fields = {"slug": ("name",)}
    ```
    **Для модели ```People``` в классе ```PeopleAdmin```:**
    ```
    prepopulated_fields = {"slug": ("title",)}
    ```
    **После сохранения изменений проверяем в админке. При добавлении новой категории или статьи поле ```slug``` будет заполняться автоматически на основе значения поля name (для категорий) или ```title``` (для статей).**

6. ## Отображение статей по слагу

    **Чтобы отображать статьи по слагу вместо идентификатора, обновляем маршруты и функции представлений:**
    
    **В ```urls.py``` заменяем тип ```<int:post_id>``` на ```<slug:post_slug>```:**
    ```
    path('post/<slug:post_slug>/', show_post, name='post')
    ```
    **В ```views.py``` изменяем функцию show_post:**
    
    ```
    def show_post(request, post_slug):
        post = get_object_or_404(People, slug=post_slug)

        context = {
            'post': post,
            'title': post.title,
            'cat_selected': post.cat_id,  
    }

        return render(request, 'people/post.html', context=context)
    ```
7. ## Обновление метода ```get_absolute_url```

    **В файле ```models.py``` в функции ```get_absolute_url``` формируем маршрут на основе ```slug:```**
    ```
    def get_absolute_url(self):
        return reverse("post", kwargs={"post_slug": self.slug})
    ```
    **Теперь ссылки на статьи будут корректно формироваться и работать на основе слага.**

8. ## Проверка работы

    **Запускаем тестовый веб-сервер:**
    ```
    python manage.py runserver
    ```
    **Переходим на сайт и проверяем отображение статьи. Адрес в строке браузера теперь будет выглядеть так:**
    ```
    http://127.0.0.1:8000/post/margo-robbi/
    ```
    **Уникальность слага гарантирует корректный выбор записи из базы данных.**

9. ## Безопасность URL

    **Django автоматически защищает URL от SQL-инъекций, так как параметры в запросах фильтруются и валидируются. Это обеспечивает безопасность вашего сайта без дополнительных усилий.**

10. ## Заключение

    **Благодаря использованию метода ```get_absolute_url``` и встроенной поддержке слагов в Django, мы смогли добавить отображение статей по слагу без изменений в шаблонах. Django делает разработку удобной и безопасной даже для начинающих веб-разработчиков.**